CREATE PROCEDURE [CLO].[spLoadFundDailySnapshot]
	@dateId int ,
	@fundId int
AS
	
	DELETE from clo.FundDailySnapshot where FundId = @fundId and DateId = @dateId

	INSERT INTO CLO.FundDailySnapshot ( 
			[DateId]
		   ,[FundId]
		   ,[FundCode]
           ,[FundDesc]
           ,[PrincipalCash]
           ,[WSOLastUpdatedOn]
           ,[LiabilityPar]
           ,[EquityPar]
           ,[TargetPar]
           ,[RecoveryMultiplier]
           ,[WALifeAdjustment]
           ,[CreatedOn]
           ,[CreatedBy]
           ,[LastUpdatedOn]
           ,[LastUpdatedBy]
           ,[CLOFileName]
           ,[IsStale]
		   ,[IsPrincipalCashStale]
           ,[DisplayText]
           ,[IsActive]
           ,[WSOSpread]
           ,[WSOWARF]
           ,[WSOMoodyRecovery]
           ,[WSOWALife]
           ,[WSODiversity]
           ,[IsWarehouse]
           ,[PortfolioName]
           ,[SortOrder]
           ,[WALWARFAdj]
           ,[MaxWarfTrigger]
           ,[ClassEPar]
           ,[WALDate]
           ,[ReInvestEndDate]
           ,[WalDateAdj]
           ,[ParentFundId]
           ,[ParentFundCode]
           ,[CanFilter]
           ,[BloombergCode]
           ,[PricingDate]
           ,[MgmtFees]
           ,[OperatingExpenses]
           ,[ClosingDate]
           ,[NonCallEndsDate]
           ,[FinalMaturity]
           ,[ProjectedEquityDistribtion]
		   
		   )
	SELECT @dateId DateId,
		   [FundId]
		   ,[FundCode]
           ,[FundDesc]
           ,[PrincipalCash]
           ,[WSOLastUpdatedOn]
           ,[LiabilityPar]
           ,[EquityPar]
           ,[TargetPar]
           ,[RecoveryMultiplier]
           ,[WALifeAdjustment]
           ,[CreatedOn]
           ,[CreatedBy]
           ,[LastUpdatedOn]
           ,[LastUpdatedBy]
           ,[CLOFileName]
           ,[IsStale]
		   ,[IsPrincipalCashStale]
           ,[DisplayText]
           ,[IsActive]
           ,[WSOSpread]
           ,[WSOWARF]
           ,[WSOMoodyRecovery]
           ,[WSOWALife]
           ,[WSODiversity]
           ,[IsWarehouse]
           ,[PortfolioName]
           ,[SortOrder]
           ,[WALWARFAdj]
           ,[MaxWarfTrigger]
           ,[ClassEPar]
           ,[WALDate]
           ,[ReInvestEndDate]
           ,[WalDateAdj]
           ,[ParentFundId]
           ,[ParentFundCode]
           ,[CanFilter]
           ,[BloombergCode]
           ,[PricingDate]
           ,[MgmtFees]
           ,[OperatingExpenses]
           ,[ClosingDate]
           ,[NonCallEndsDate]
           ,[FinalMaturity]
           ,[ProjectedEquityDistribtion]
	from CLO.Fund where FundId = @fundId		 

RETURN 0
